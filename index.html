<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EvalVoice - Application d'aide √† l'√©valuation</title>
  <link rel="stylesheet" href="styles/styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <script type="module">
    import { questions, currentQuestion, responses, recognition, synthesis, recordingStudentInfo, recordingResponse, speechRate } from './functions/globals.js';
    import initializeRecognition from './functions/initializeRecognition.js';
    import loadDocument from './functions/loadDocument.js';
    import { extractQuestions } from './functions/extractQuestions.js';
    
    document.addEventListener('DOMContentLoaded', (event) => {
      if ('speechSynthesis' in window && ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window)) {
        initializeRecognition();
      } else {
        alert("Votre navigateur ne supporte pas la synth√®se vocale ou la reconnaissance vocale.");
      }

      document.getElementById('recordStudentInfo').addEventListener('click', () => {
        recordingStudentInfo = true;
        recognition.start();
        document.getElementById('recordingIndicator').style.display = 'block';
      });

      document.getElementById('responseInput').addEventListener('input', (event) => {
        responses[currentQuestion] = event.target.value;
      });

      document.getElementById('prevQuestion').addEventListener('click', () => navigateQuestion(-1));
      document.getElementById('nextQuestion').addEventListener('click', () => navigateQuestion(1));
      document.getElementById('exportResponses').addEventListener('click', exportResponses);
      document.getElementById('speedDown').addEventListener('click', () => adjustSpeechRate(-0.1));
      document.getElementById('speedUp').addEventListener('click', () => adjustSpeechRate(0.1));
    });

    async function loadDocumentWrapper() {
      await loadDocument();
    }

    document.getElementById('loadDocumentButton').addEventListener('click', loadDocumentWrapper);

    // Autres fonctions ici...
  </script>
</head>
<body>
  <div class="container">
    <div class="top-right">
      <button id="loadPdfButton" onclick="window.location.href='pdf.html'">PDF</button>
    </div>
    <div class="left-pane">
      <h1>Eval Voice</h1>
      <div class="input-group">
        <input type="text" id="studentName" placeholder="Pr√©nom, Nom, Classe">
        <button id="recordStudentInfo"><span>&#127897;</span></button>
      </div>
      <div class="centre">
        <p>Entrez l'URL d'un document Google Docs <br> puis cliquez sur "Charger le document" pour commencer.</p>
        <input type="text" id="urlInput" placeholder="URL Google Docs">
        <button id="loadDocumentButton">Charger le document</button><br>
        <button id="prevQuestion" disabled>Question pr√©c√©dente</button>
        <button id="nextQuestion" disabled>Question suivante</button>
      </div>
      <div id="questionDisplay"></div>
      <div class="input-group">
        <input type="text" id="responseInput" placeholder="R√©ponse">
      </div>
      <div class="feedback">
        <div id="recordingIndicator" style="display: none;">üéôÔ∏è Enregistrement...</div>
        <div id="synthesisIndicator" style="display: none;">üîä Lecture...</div>
      </div>
      <div class="centre">
        <button id="speedDown">-</button>
        <span id="speedDisplay">1.0x</span>
        <button id="speedUp">+</button>   
        <br>
        <button id="exportResponses" disabled>Exporter les r√©ponses</button>
      </div>
    </div>
    <div class="right-pane">
      <iframe id="pdfViewer"></iframe>
    </div>
  </div>
</body>
</html>
